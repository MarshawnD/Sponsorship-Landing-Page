<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tabbed Audience Charts</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-black text-white p-10">

<div class="max-w-5xl mx-auto bg-white rounded-2xl overflow-hidden text-black">
  <!-- Tabs -->
<div class="flex">
  <button class="tab-button px-6 py-4 font-semibold w-1/3" onclick="showTab(0)">CapRadio Audience</button>
  <button class="tab-button px-6 py-4 font-semibold w-1/3" onclick="showTab(1)">News Composition</button>
  <button class="tab-button px-6 py-4 font-semibold w-1/3" onclick="showTab(2)">Music Composition</button>
</div>

<!-- Tab Content -->
<div class="p-6 bg-white" id="tab-content">
  <!-- Filled by JavaScript -->
</div>

<style>
  button { background-color: #6B1E1E; color: white; }
  .active-tab { background-color: #ffffff; color: #6B1E1E; }
</style>

  <script>
    const tabData = [
      {
        genderPercentage: [0, 0],
        agePercentage: [0],
        incomePercentage: [0]
      },
      {
        genderPercentage: [48, 52],
        agePercentage: [17, 19, 15, 15, 34],
        incomePercentage: [60, 27, 13]
      },
      {
        genderPercentage: [50, 50],
        agePercentage: [13, 20, 2, 3, 62],
        incomePercentage: [50, 10, 40]
      }
    ];

    const age = ['18–34', '35–44', '45–54', '55–64', '65+'];
    const income = ['$100K+', '$50K–$100K', 'Under $50K'];
    const gender = ['Female', 'Male'];

    let currentChartInstances = [];

    function showTab(index) {
      // Remove active class from all buttons
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active-tab'));
      // Add active class to the clicked tab
      document.querySelectorAll('.tab-button')[index].classList.add('active-tab');

      const data = tabData[index];

      const genderChartLabels = data.genderPercentage.map((v, i) => `${v}% ${gender[i]}`);
      const ageChartLabels = data.agePercentage.map((v, i) => `${v}% ${age[i]}`);
      const incomeChartLabels = data.incomePercentage.map((v, i) => `${v}% ${income[i]}`);

      document.getElementById('tab-content').innerHTML = `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-gray-100 p-4 rounded-xl">
            <p class="text-center">CapRadio news listeners spend over <strong>$2.5 billion annually</strong> in metro area retail sales</p>
          </div>
          <div class="bg-gray-100 p-4 rounded-xl">
            <h3 class="text-center text-lg mt-2">Gender</h3>
            <canvas id="genderChart"></canvas>
          </div>
          <div class="bg-gray-100 p-4 rounded-xl">
            <h3 class="text-center text-lg mt-2">Age Ranges</h3>
            <canvas id="ageChart"></canvas>
          </div>
          <div class="bg-gray-100 p-4 rounded-xl">
            <h3 class="text-center text-lg mt-2">Household Income</h3>
            <canvas id="incomeChart"></canvas>
          </div>
        </div>
        <p class="text-xs mt-4 italic">
          Sources: Information about where we sourced our data. Some more info and maybe a link or just date ranges.
        </p>
      `;

      // Destroy old charts to prevent duplication
      currentChartInstances.forEach(chart => chart.destroy());
      currentChartInstances = [];

      const commonOptions = {
        plugins: {
          legend: {
            position: 'right',
            labels: {
              usePointStyle: true,
              pointStyle: 'circle',
              padding: 12,
              boxWidth: 10
            }
          }
        }
      };

      currentChartInstances.push(new Chart(document.getElementById('genderChart'), {
        type: 'pie',
        data: {
          labels: genderChartLabels,
          datasets: [{
            data: data.genderPercentage,
            backgroundColor: ['#4DA6B3', '#134C5E'],
            borderWidth: 0
          }]
        },
        options: commonOptions
      }));

      currentChartInstances.push(new Chart(document.getElementById('ageChart'), {
        type: 'doughnut',
        data: {
          labels: ageChartLabels,
          datasets: [{
            data: data.agePercentage,
            backgroundColor: ['#E27D60', '#E8A87C', '#C38D9E', '#41B3A3', '#6B1E1E'],
            borderWidth: 0
          }]
        },
        options: commonOptions
      }));

      currentChartInstances.push(new Chart(document.getElementById('incomeChart'), {
        type: 'pie',
        data: {
          labels: incomeChartLabels,
          datasets: [{
            data: data.incomePercentage,
            backgroundColor: ['#6B1E1E', '#A63D40', '#D95D39'],
            borderWidth: 0
          }]
        },
        options: commonOptions
      }));
    }

    // Initial tab load
    showTab(1);
  </script>
</body>
</html>
